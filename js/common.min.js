function getRankInfo(i,e){var t=Number.MAX_VALUE;i.stirfry>0&&(t=Math.min(t,e.stirfryVal/i.stirfry)),i.boil>0&&(t=Math.min(t,e.boilVal/i.boil)),i.knife>0&&(t=Math.min(t,e.knifeVal/i.knife)),i.fry>0&&(t=Math.min(t,e.fryVal/i.fry)),i.bake>0&&(t=Math.min(t,e.bakeVal/i.bake)),i.steam>0&&(t=Math.min(t,e.steamVal/i.steam));var a=new Object,r=0,n="-",o=0;return t!=Number.MAX_VALUE&&(t>=4?(r=50,n="神",o=4):t>=3?(r=30,n="特",o=3):t>=2?(r=10,n="优",o=2):t>=1&&(r=0,n="可",o=1)),a.rankAddition=r,a.rankDisp=n,a.rankVal=o,a}function getRecipeSkillAddition(i,e){var t=0;for(var a in i){var r=i[a].type,n=!1;if("UseFish"==r){for(var o in e.materials)if("池塘"==e.materials[o].origin){n=!0;break}}else if("UseCreation"==r){for(var o in e.materials)if("作坊"==e.materials[o].origin){n=!0;break}}else if("UseMeat"==r){for(var o in e.materials)if("牧场"==e.materials[o].origin||"鸡舍"==e.materials[o].origin||"猪圈"==e.materials[o].origin){n=!0;break}}else if("UseVegetable"==r){for(var o in e.materials)if("菜棚"==e.materials[o].origin||"菜地"==e.materials[o].origin||"森林"==e.materials[o].origin){n=!0;break}}else"UseStirfry"==r?e.stirfry>0&&(n=!0):"UseBoil"==r?e.boil>0&&(n=!0):"UseFry"==r?e.fry>0&&(n=!0):"UseKnife"==r?e.knife>0&&(n=!0):"UseBake"==r?e.bake>0&&(n=!0):"UseSteam"==r?e.steam>0&&(n=!0):"Gold_Gain"==r&&(n=!0);n&&(t=t.add(i[a].value))}return t}function getMaterialsAddition(i,e){var t=0;for(var a in i.materials)for(var r in e)if(i.materials[a].material==e[r].materialId&&e[r].addition){t=t.add(Number(e[r].addition));break}return t}function getPercentDisp(i){return i?i+"%":""}function getRecipeQuantity(i,e,t){var a=1;t.hasOwnProperty("DisableMultiCookbook")&&0!=t.DisableMultiCookbook||(a=i.limitVal);for(var r in i.materials){var n=!1;for(var o in e)if(i.materials[r].material==e[o].materialId){if(n=!0,e[o].quantity){var l=Math.floor(e[o].quantity/i.materials[r].quantity);l<a&&(a=l);break}if(0===e[o].quantity)return 0}if(!n)return 0}return a<0?0:a}function getRecipeResult(i,e,t,a,r,n,o,l){var s=new Object,d=0,f=0,c=0,p=0,u=0,m=0;if(s.disp=t.name,i){var b=getRankInfo(t,i);if(s.rankVal=b.rankVal,s.rankDisp=b.rankDisp,0==b.rankVal)return s;o&&o.hasOwnProperty("DisableCookbookRank")&&0!=o.DisableCookbookRank||(d=b.rankAddition),s.rankAdditionDisp=getPercentDisp(d),o&&o.hasOwnProperty("DisableChefSkillEffect")&&0!=o.DisableChefSkillEffect||(f=getRecipeSkillAddition(i.specialSkillEffect,t),m=getTimeAddition(i.specialSkillEffect)),s.chefSkillAdditionDisp=getPercentDisp(f),o&&o.hasOwnProperty("DisableEquipSkillEffect")&&0!=o.DisableEquipSkillEffect||e&&(c=getRecipeSkillAddition(e.effect,t),m=getTimeAddition(e.effect)),s.equipSkillAdditionDisp=getPercentDisp(c),u=u.add(Number(i.addition))}if(o&&o.hasOwnProperty("DisableDecorationEffect")&&0!=o.DisableDecorationEffect||l&&(p=l),s.decorationAdditionDisp=getPercentDisp(p),u=u.add(Number(t.addition)),o&&o.hasOwnProperty("MaterialsEffect")&&o.MaterialsEffect.length>0){var g=getMaterialsAddition(t,n);u=u.add(g)}var h=d.add(f).add(c).add(p).add(t.ultimateAddition);s.data=t,s.quantity=a,s.max=r,s.limit=a,s.bonusAdditionDisp=getPercentDisp(u.mul(100)),s.totalPrice=t.price*a,s.realPrice=Math.ceil(t.price.mul(Number(1).add(h.div(100)))),s.totalRealPrice=s.realPrice*a;var k=Math.ceil(t.price.mul(Number(1).add(h.div(100)).add(u)));s.bonusScore=k-s.realPrice,s.totalBonusScore=s.bonusScore*a,s.totalScore=k*a;var D=Math.ceil(t.time.mul(Number(1).add(m.div(100))));s.totalTime=D*a,s.totalTimeDisp=secondsToTime(s.totalTime);var y=0;return i&&s.rankVal>0&&(y=Math.floor(3600*s.realPrice/D)),s.chefEff=y,s}function calAddition(i,e){return i.mul(e.percent).div(100).add(e.abs)}function getTimeAddition(i,e){var i=0;for(var t in e)"OpenTime"==e[t].type&&(i=i.add(e[t].value));return i}function setAddition(i,e){"Abs"==e.cal?i.abs=i.abs.add(e.value):"Percent"==e.cal&&(i.percent=i.percent.add(e.value))}function Addition(){this.abs=0,this.percent=0}function secondsToTime(i){i=Number(i);var e=Math.floor(i/3600/24),t=Math.floor(i/3600%24),a=Math.floor(i/60%60),r=Math.floor(i%60),n="";return e>0&&(n+=e+"天"),t>0&&(n+=t+"小时"),a>0&&(n+=a+"分"),r>0&&(n+=r+"秒"),n}function getEquipInfo(i,e){var t=null;if(i)for(var a in e)if(i==e[a].name){t=[],t.name=e[a].name,t.effect=e[a].effect,t.disp=e[a].name+"<br><small>"+e[a].skillDisp+"</small>";break}return t}function setDataForChef(i,e,t,a){i.stirfryVal=i.stirfry,i.boilVal=i.boil,i.knifeVal=i.knife,i.fryVal=i.fry,i.bakeVal=i.bake,i.steamVal=i.steam,i.stirfryDisp=i.stirfry||"",i.boilDisp=i.boil||"",i.knifeDisp=i.knife||"",i.fryDisp=i.fry||"",i.bakeDisp=i.bake||"",i.steamDisp=i.steam||"";var r=new Addition,n=new Addition,o=new Addition,l=new Addition,s=new Addition,d=new Addition,f=a;t&&e&&(f=f.concat(e.effect)),i.ultimateSelfEffect&&(f=f.concat(i.ultimateSelfEffect));for(var c in f){var p=f[c].type,u=f[c].gender;u&&u!=i.gender||("Stirfry"==p&&setAddition(r,f[c]),"Boil"==p&&setAddition(n,f[c]),"Knife"==p&&setAddition(o,f[c]),"Fry"==p&&setAddition(l,f[c]),"Bake"==p&&setAddition(s,f[c]),"Steam"==p&&setAddition(d,f[c]))}var m=Math.ceil(calAddition(i.stirfry,r)),b=Math.ceil(calAddition(i.boil,n)),g=Math.ceil(calAddition(i.knife,o)),h=Math.ceil(calAddition(i.fry,l)),k=Math.ceil(calAddition(i.bake,s)),D=Math.ceil(calAddition(i.steam,d));m&&(i.stirfryVal+=m,i.stirfryDisp+=getChefAdditionDisp(m)),b&&(i.boilVal+=b,i.boilDisp+=getChefAdditionDisp(b)),g&&(i.knifeVal+=g,i.knifeDisp+=getChefAdditionDisp(g)),h&&(i.fryVal+=h,i.fryDisp+=getChefAdditionDisp(h)),k&&(i.bakeVal+=k,i.bakeDisp+=getChefAdditionDisp(k)),D&&(i.steamVal+=D,i.steamDisp+=getChefAdditionDisp(D)),i.disp=i.name+"<br><small>";var y=0;i.stirfryDisp&&(i.disp+="炒"+i.stirfryDisp+" ",y++),i.boilDisp&&(i.disp+="煮"+i.boilDisp+" ",y++,y%2==0&&(i.disp+="<br>")),i.knifeDisp&&(i.disp+="切"+i.knifeDisp+" ",y++,y%2==0&&(i.disp+="<br>")),i.fryDisp&&(i.disp+="炸"+i.fryDisp+" ",y++,y%2==0&&(i.disp+="<br>")),i.bakeDisp&&(i.disp+="烤"+i.bakeDisp+" ",y++,y%2==0&&(i.disp+="<br>")),i.steamDisp&&(i.disp+="蒸"+i.steamDisp+" "),i.disp+="</small>"}function getChefAdditionDisp(i){var e="";return i>0&&(e+="+"),e+=i}function isNumeric(i){return!isNaN(parseFloat(i))&&isFinite(i)}function accAdd(i,e){isNaN(i)&&(i=0),isNaN(e)&&(e=0),i=Number(i),e=Number(e);var t,a,r,n;try{t=i.toString().split(".")[1].length}catch(i){t=0}try{a=e.toString().split(".")[1].length}catch(i){a=0}if(n=Math.abs(t-a),r=Math.pow(10,Math.max(t,a)),n>0){var o=Math.pow(10,n);t>a?(i=Number(i.toString().replace(".","")),e=Number(e.toString().replace(".",""))*o):(i=Number(i.toString().replace(".",""))*o,e=Number(e.toString().replace(".","")))}else i=Number(i.toString().replace(".","")),e=Number(e.toString().replace(".",""));return(i+e)/r}function accSub(i,e){isNaN(i)&&(i=0),isNaN(e)&&(e=0),i=Number(i),e=Number(e);var t,a,r,n;try{t=i.toString().split(".")[1].length}catch(i){t=0}try{a=e.toString().split(".")[1].length}catch(i){a=0}return r=Math.pow(10,Math.max(t,a)),n=t>=a?t:a,((i*r-e*r)/r).toFixed(n)}function accMul(i,e){isNaN(i)&&(i=0),isNaN(e)&&(e=0),i=Number(i),e=Number(e);var t=0,a=i.toString(),r=e.toString();try{t+=a.split(".")[1].length}catch(i){}try{t+=r.split(".")[1].length}catch(i){}return Number(a.replace(".",""))*Number(r.replace(".",""))/Math.pow(10,t)}function accDiv(arg1,arg2){isNaN(arg1)&&(arg1=0),isNaN(arg2)&&(arg2=0),arg1=Number(arg1),arg2=Number(arg2);var t1=0,t2=0,r1,r2;try{t1=arg1.toString().split(".")[1].length}catch(i){}try{t2=arg2.toString().split(".")[1].length}catch(i){}with(Math)return r1=Number(arg1.toString().replace(".","")),r2=Number(arg2.toString().replace(".","")),r1/r2*pow(10,t2-t1)}Number.prototype.add=function(i){return accAdd(this,i)},Number.prototype.sub=function(i){return accSub(this,i)},Number.prototype.mul=function(i){return accMul(this,i)},Number.prototype.div=function(i){return accDiv(this,i)};
function getRankInfo(i,e){var t=Number.MAX_VALUE;i.stirfry>0&&(t=Math.min(t,e.stirfryVal/i.stirfry)),i.boil>0&&(t=Math.min(t,e.boilVal/i.boil)),i.knife>0&&(t=Math.min(t,e.knifeVal/i.knife)),i.fry>0&&(t=Math.min(t,e.fryVal/i.fry)),i.bake>0&&(t=Math.min(t,e.bakeVal/i.bake)),i.steam>0&&(t=Math.min(t,e.steamVal/i.steam));var a=new Object,r=0,n="-",s=0;return t!=Number.MAX_VALUE&&(t>=4?(r=50,n="神",s=4):t>=3?(r=30,n="特",s=3):t>=2?(r=10,n="优",s=2):t>=1&&(r=0,n="可",s=1)),a.rankAddition=r,a.rankDisp=n,a.rankVal=s,a}function getRecipeSkillAddition(i,e){var t=0;for(var a in i){var r=i[a].type,n=!1;if("UseFish"==r){for(var s in e.materials)if("池塘"==e.materials[s].origin){n=!0;break}}else if("UseCreation"==r){for(var s in e.materials)if("作坊"==e.materials[s].origin){n=!0;break}}else if("UseMeat"==r){for(var s in e.materials)if("牧场"==e.materials[s].origin||"鸡舍"==e.materials[s].origin||"猪圈"==e.materials[s].origin){n=!0;break}}else if("UseVegetable"==r){for(var s in e.materials)if("菜棚"==e.materials[s].origin||"菜地"==e.materials[s].origin||"森林"==e.materials[s].origin){n=!0;break}}else"UseStirfry"==r?e.stirfry>0&&(n=!0):"UseBoil"==r?e.boil>0&&(n=!0):"UseFry"==r?e.fry>0&&(n=!0):"UseKnife"==r?e.knife>0&&(n=!0):"UseBake"==r?e.bake>0&&(n=!0):"UseSteam"==r?e.steam>0&&(n=!0):"Gold_Gain"==r&&(n=!0);n&&(t+=i[a].value)}return+t.toFixed(2)}function getMaterialsAddition(i,e){var t=0;for(var a in i.materials)for(var r in e)if(i.materials[a].material==e[r].materialId&&e[r].addition){t+=Number(e[r].addition);break}return+t.toFixed(2)}function getPercentDisp(i){return 0!=i?i.toString()+"%":""}function getRecipeQuantity(i,e,t){var a=1;t.hasOwnProperty("DisableMultiCookbook")&&0!=t.DisableMultiCookbook||(a=i.limitVal);for(var r in i.materials){var n=!1;for(var s in e)if(i.materials[r].material==e[s].materialId){if(n=!0,e[s].quantity){var l=Math.floor(e[s].quantity/i.materials[r].quantity);l<a&&(a=l);break}if(0===e[s].quantity)return 0}if(!n)return 0}return a<0?0:a}function getRecipeResult(i,e,t,a,r,n,s,l){var o=new Object,f=0,d=0,c=0,p=0,b=0;if(o.disp=t.name,i){var m=getRankInfo(t,i);if(o.rankVal=m.rankVal,o.rankDisp=m.rankDisp,0==m.rankVal)return o;s&&s.hasOwnProperty("DisableCookbookRank")&&0!=s.DisableCookbookRank||(f=m.rankAddition),o.rankAdditionDisp=getPercentDisp(f),s&&s.hasOwnProperty("DisableChefSkillEffect")&&0!=s.DisableChefSkillEffect||(d=getRecipeSkillAddition(i.specialSkillEffect,t)),o.chefSkillAdditionDisp=getPercentDisp(d),s&&s.hasOwnProperty("DisableEquipSkillEffect")&&0!=s.DisableEquipSkillEffect||e&&(c=getRecipeSkillAddition(e.effect,t)),o.equipSkillAdditionDisp=getPercentDisp(c),b+=Number(i.addition)}if(s&&s.hasOwnProperty("DisableDecorationEffect")&&0!=s.DisableDecorationEffect||l&&(p=l),o.decorationAdditionDisp=getPercentDisp(p),b+=Number(t.addition),s&&s.hasOwnProperty("MaterialsEffect")){var u=getMaterialsAddition(t,n);b+=u}var k=(f+d+c+p+t.ultimateAddition)/100;o.data=t,o.quantity=a,o.max=r,o.limit=a,o.bonusAdditionDisp=getPercentDisp(+(100*b).toFixed(2)),o.totalPrice=t.price*a,o.realPrice=Math.ceil(+(t.price*(1+k)).toFixed(2)),o.totalRealPrice=o.realPrice*a;var D=Math.ceil(+(t.price*(1+k+b)).toFixed(2));o.bonusScore=D-o.realPrice,o.totalBonusScore=o.bonusScore*a,o.totalScore=D*a,o.totalTime=t.time*a,o.totalTimeDisp=secondsToTime(o.totalTime);var h=Math.floor(3600*o.realPrice/t.time);o.efficiency=h;var A=0;return i&&o.rankVal>0&&(A=h),o.chefEff=A,o}function calAddition(i,e){return+((i+e.abs)*(1+e.percent/100)).toFixed(2)}function getTimeAddition(i){var e=0;for(var t in i)"OpenTime"==i[t].type&&(e+=i[t].value);return+e.toFixed(2)}function setAddition(i,e){"Abs"==e.cal?i.abs=+(i.abs+e.value).toFixed(2):"Percent"==e.cal&&(i.percent=+(i.percent+e.value).toFixed(2))}function Addition(){this.abs=0,this.percent=0}function secondsToTime(i){i=Number(i);var e=Math.floor(i/3600/24),t=Math.floor(i/3600%24),a=Math.floor(i/60%60),r=Math.floor(i%60),n="";return e>0&&(n+=e+"天"),t>0&&(n+=t+"小时"),a>0&&(n+=a+"分"),r>0&&(n+=r+"秒"),n}function getEquipInfo(i,e){var t=null;if(i)for(var a in e)if(i==e[a].name){t=[],t.name=e[a].name,t.effect=e[a].effect,t.disp=e[a].name+"<br><small>"+e[a].skillDisp+"</small>";break}return t}function setDataForChef(i,e,t,a){var r=new Addition,n=new Addition,s=new Addition,l=new Addition,o=new Addition,f=new Addition,d=0,c=0,p=0,b=0,m=a;t&&e&&(m=m.concat(e.effect)),i.ultimateSelfEffect&&(m=m.concat(i.ultimateSelfEffect));for(var u in m){var k=m[u].type,D=m[u].tag;D&&i.tags.indexOf(D)<0||("Stirfry"==k?setAddition(r,m[u]):"Boil"==k?setAddition(n,m[u]):"Knife"==k?setAddition(s,m[u]):"Fry"==k?setAddition(l,m[u]):"Bake"==k?setAddition(o,m[u]):"Steam"==k?setAddition(f,m[u]):"Meat"==k?d+=m[u].value:"Creation"==k?c+=m[u].value:"Vegetable"==k?p+=m[u].value:"Fish"==k&&(b+=m[u].value))}i.meatVal=i.meat+d,i.creationVal=i.creation+c,i.vegVal=i.veg+p,i.fishVal=i.fish+b,i.meatDisp=getChefAtrributeDisp(i.meatVal,i.meat),i.creationDisp=getChefAtrributeDisp(i.creationVal,i.creation),i.vegDisp=getChefAtrributeDisp(i.vegVal,i.veg),i.fishDisp=getChefAtrributeDisp(i.fishVal,i.fish),i.stirfryVal=Math.ceil(calAddition(i.stirfry,r)),i.boilVal=Math.ceil(calAddition(i.boil,n)),i.knifeVal=Math.ceil(calAddition(i.knife,s)),i.fryVal=Math.ceil(calAddition(i.fry,l)),i.bakeVal=Math.ceil(calAddition(i.bake,o)),i.steamVal=Math.ceil(calAddition(i.steam,f)),i.stirfryDisp=getChefAtrributeDisp(i.stirfryVal,i.stirfry),i.boilDisp=getChefAtrributeDisp(i.boilVal,i.boil),i.knifeDisp=getChefAtrributeDisp(i.knifeVal,i.knife),i.fryDisp=getChefAtrributeDisp(i.fryVal,i.fry),i.bakeDisp=getChefAtrributeDisp(i.bakeVal,i.bake),i.steamDisp=getChefAtrributeDisp(i.steamVal,i.steam),i.disp=i.name+"<br><small>";var h=0;i.stirfryDisp&&(i.disp+="炒"+i.stirfryDisp+" ",h++),i.boilDisp&&(i.disp+="煮"+i.boilDisp+" ",h++,h%2==0&&(i.disp+="<br>")),i.knifeDisp&&(i.disp+="切"+i.knifeDisp+" ",h++,h%2==0&&(i.disp+="<br>")),i.fryDisp&&(i.disp+="炸"+i.fryDisp+" ",h++,h%2==0&&(i.disp+="<br>")),i.bakeDisp&&(i.disp+="烤"+i.bakeDisp+" ",h++,h%2==0&&(i.disp+="<br>")),i.steamDisp&&(i.disp+="蒸"+i.steamDisp+" "),i.disp+="</small>"}function getChefAtrributeDisp(i,e){var t="";e&&(t+=e);var a=i-e;return a&&(a>0&&(t+="+"),t+=a),t}function isNumeric(i){return!isNaN(parseFloat(i))&&isFinite(i)}